<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="/ffmpeg-icon.png" />
    <meta charset="UTF-8" />
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script>
      console.log(window.location.pathname);

      const [title] = window.location.pathname.replace('.job', '').split('/').slice(-1);
      document.title = title;

      $(() => {
        const socket = io();
        socket.on('connect', () => {
          console.log('connected');

          socket.emit('tail', window.location.pathname);
          $('#tailing').empty();
        });
        socket.on('newLine', data => {
          $('#tailing').append(data.line);
          $('#end').get(0).scrollIntoView();
        });
      });
    </script>
  </head>

  <body>
    <pre id="tailing" style="background-color: antiquewhite;"></pre>
    <div id="end"></div>
  </body>
</html>
